<!DOCTYPE html>
<html>
	<head>
		<title>{{#i18n}}blog.title{{/i18n}}</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script src="{{#infra}}js/loader.js{{/infra}}" type="text/javascript" id="context"></script>
		<script src="{{#static}}js/model.js{{/static}}" type="text/javascript"></script>
		<script src="{{#static}}js/controller.js{{/static}}" type="text/javascript"></script>
	</head>
	<body data-ng-controller="Blog">
	<portal>
	<div class="row">
		<div class="four cell">
			<h1><a data-reload><i role="blog"></i>{{#i18n}}blog.title{{/i18n}}</a></h1>
		</div>
		<div class="eight cell">
			<nav class="contextual-buttons row" ng-if="currentBlog._id">
				<div class="row">
					<button data-ng-click="showCreatePost()" data-ng-disabled="isEditing()" data-ng-if="isVisible()">
						<i role="add"></i>{{#i18n}}blog.create.post{{/i18n}}
					</button>
				</div>
			</nav>
		</div>
	</div>
	<div class="row">
		<div class="four cell">
			<nav class="vertical">
				<div data-ng-repeat="blog in blogs">
					<article class="height-four twelve clip small-text cell" data-ng-class="{
							'lower-line': $index !== 0,
							 'selected':isSelected(blog._id)
							 }">
						<div class="four cell fixed" data-ng-click="displayBlog(blog)">
							<img ng-src="[[blogThumbnail(blog)]]" />
						</div>
						<div class="eight cell absolute right-magnet text-container">
							<div class="row">
								<h3 data-ng-click="displayBlog(blog)">[[blog.shortened]]</h3>
							</div>
							<div class="row bottom-locked vertical-spacing">
								<a ng-href="/userbook/annuaire#[[blog.author.userId]]">
									<strong>{{#i18n}}blog.by{{/i18n}} [[blog.author.username]]</strong>
								</a>
							</div>
						</div>
					</article>
					<a data-ng-click="showEditBlog(blog)" ng-if="blog.myRights.blog.edit" class="small-text">{{#i18n}}blog.edit.title{{/i18n}}</a>
				</div>
				<a data-ng-click="showCreateBlog()" ng-if="me.myRights.blog.post" class="cell vertical-spacing-twice">{{#i18n}}blog.create.blog{{/i18n}}</a>
			</nav>
	</div>
	<div class="eight cell horizontal-spacing">
			<h3 data-ng-if="isCurrentView('createBlog')">{{#i18n}}blog.create.title{{/i18n}}</h3>
		    <h1 class="text" ng-if="(isCurrentView('listPosts') || isCurrentView('editBlog')) && blogs.length !== 0">[[currentBlog.title]]</h1>
			<em class="medium-importance" ng-if="(isCurrentView('listPosts') || isCurrentView('editBlog')) && blogs.length !== 0"><span translate key="blog.by"></span> <a ng-href="/userbook/annuaire#[[currentBlog.author.userId]]">[[currentBlog.author.username]]</a></em>
			<div class="row">
				<hr />
			</div>
			<article class="row">
				<section data-ng-include="currentView.path" class="row"></section>
			</article>
		</div>
		<div class="clear"></div>
		</div>
	</portal>
	<section class="lightbox-backdrop"></section>
	<section class="lightbox-window six cell">
		<div class="twelve cell">
				<section ng-include="lightboxPath">
				</section>
		</div>
		<div class="close-lightbox">
			<i role="close-2x"></i>
		</div>
		<div class="clear"></div>
	</section>
	</body>
</html>
