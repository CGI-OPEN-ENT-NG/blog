<div class="fallen dominos">
    <!-- Empty screen Création -->
    <div class="emptyscreen"
        ng-if="hasFiltersActive() && !currentFolder.ressources.all.length && !currentFolder.children.all.length"
        workflow="blog.create">
        <h2 class="emptyscreen-header">
            <i18n ng-if="currentFolder === root">empty.blog.creation.title</i18n>
            <i18n ng-if="currentFolder !== root">empty.blog.subfolder.title</i18n>
        </h2>
        <img ng-if="currentFolder === root" class="emptyscreen-image__mini" src="/blog/public/img/empty-blog.svg">
        <img ng-if="currentFolder !== root" class="emptyscreen-image__mini"
            src="/assets/themes/entcore-css-lib/images/empty-search.svg">
        <p class="emptyscreen-footer">
            <i18n ng-if="currentFolder === root">empty.blog.creation</i18n>
        </p>
        <a class="button" ng-href="#/edit/new" workflow="blog.create">
            <i18n>blog.create.blog</i18n>
        </a>
    </div>
    <!-- 1D Consultation -->
    <div class="emptyscreen"
        ng-if="hasFiltersActive() && !currentFolder.ressources.all.length && !currentFolder.children.all.length"
        workflow-not="blog.create">
        <h2 class="emptyscreen-header">
            <i18n ng-if="currentFolder === root">empty.blog.consultation.title</i18n>
            <i18n ng-if="currentFolder !== root">empty.blog.subfolder.title</i18n>
        </h2>
        <img ng-if="currentFolder === root" class="emptyscreen-image__mini" src="/blog/public/img/empty-blog.svg">
        <img ng-if="currentFolder !== root" class="emptyscreen-image__mini"
            src="/assets/themes/entcore-css-lib/images/empty-search.svg">
        <p class="emptyscreen-footer">
            <i18n ng-if="currentFolder === root">empty.blog.consultation</i18n>
        </p>
    </div>
    <!-- Si la recherche n'a rien donné -->
    <div class="emptyscreen" ng-if="displayLib.searchBlogs &&
        (currentFolder.ressources.all.length || currentFolder.children.all.length) &&
        (filteredFolders = (currentFolder.children.all | filter:searchFolder)).length == 0 &&
        (filteredBlogs = (currentFolder.ressources.all | filter:searchBlog)).length == 0">
        <h2 class="emptyscreen-header">
            <i18n>empty.search.title</i18n>
        </h2>
        <img class="emptyscreen-image__mini" src="/assets/themes/entcore-css-lib/images/empty-search.svg">
        <p class="emptyscreen-footer">
            <i18n>empty.search</i18n>
        </p>
    </div>
    <!-- Si les filtres sont tous désactivés -->
    <div class="emptyscreen" ng-if="!(displayLib.searchBlogs && filteredFolders.length == 0 && filteredBlogs.length == 0)
        && !hasFiltersActive() && !currentFolder.ressources.filtered.length
        && !currentFolder.children.all.length">
        <h2 class="emptyscreen-header">
            <i18n>empty.filters.title</i18n>
        </h2>
        <img class="emptyscreen-image__mini" src="/assets/themes/entcore-css-lib/images/empty-filters.svg">
        <p class="emptyscreen-footer">
            <i18n>empty.blog.filter</i18n>
        </p>
    </div>

    <div ng-repeat="folder in currentFolder.children.all | filter:searchFolder">
        <explorer ng-model="folder.selected" on-open="open(folder)" class="folder item">
            <section class="domino" dragstart ng-model="folder._id" dragdrop="dropTo(folder, $originalEvent)">
                <div class="top">
                    <i class="folder-large"></i>
                </div>
                <div class="bottom">
                    <div class="content">
                        <strong>[[folder.shortenedName]]</strong>
                    </div>
                </div>
            </section>
        </explorer>
    </div>
    <div ng-repeat="blog in currentFolder.ressources.filtered | filter:searchBlog">
        <explorer ng-model="blog.selected" on-open="open(blog)" class="item">
            <section class="domino" dragstart ng-model="blog._id">
                <div class="top">
                    <img skin-src="/img/illustrations/blog.png" ng-if="!blog.icon" class="absolute">
                    <img image-lazy-load="blog.icon" ng-if="blog.icon" class="absolute" />
                </div>
                <div class="bottom">
                    <div class="content">
                        <strong class="block overflow-hd">[[blog.shortenedTitle]]</strong>
                        <span class="cell-ellipsis block">[[blog.author.username]]</span>
                        <em class="smaller-text block">
                            <i18n>real.modified.on</i18n>
                        </em>
                        <br />
                        <div class="icons">
                            <!-- Il faut revoir les conditions du ng-if -->
                            <i class="ic-share inline" ng-if="blog.shared.length > 0" tooltip="tooltip.shared"></i>
                            <i class="public" ng-if="blog.visibility === 'PUBLIC'" tooltip="tooltip.public"></i>
                            <i class="manage" ng-if="blog.myRights.removeBlog" tooltip="tooltip.manager"></i>
                            <i class="edit" ng-if="!blog.myRights.removeBlog && blog.myRights.createPost"
                                tooltip="tooltip.update"></i>
                            <i class="view" ng-if="!blog.myRights.createPost" tooltip="tooltip.read"></i>
                        </div>
                    </div>
                </div>
            </section>
        </explorer>
    </div>
</div>
<container template="library/toaster"></container>